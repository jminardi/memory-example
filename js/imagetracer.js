!function(){"use strict";function t(){var q=this;this.versionnumber="1.2.6",this.imageToSVG=function(t,e,n){n=q.checkoptions(n),q.loadImage(t,function(t){e(q.imagedataToSVG(q.getImgdata(t),n))},n)},this.imagedataToSVG=function(t,e){e=q.checkoptions(e);var n=q.imagedataToTracedata(t,e);return q.getsvgstring(n,e)},this.imageToTracedata=function(t,e,n){n=q.checkoptions(n),q.loadImage(t,function(t){e(q.imagedataToTracedata(q.getImgdata(t),n))},n)},this.imagedataToTracedata=function(t,e){e=q.checkoptions(e);var n=q.colorquantization(t,e);if(0===e.layering)for(var r={layers:[],palette:n.palette,width:n.array[0].length-2,height:n.array.length-2},o=0;o<n.palette.length;o++){var s=q.batchtracepaths(q.internodes(q.pathscan(q.layeringstep(n,o),e.pathomit),e),e.ltres,e.qtres);r.layers.push(s)}else{var a=q.layering(n);e.layercontainerid&&q.drawLayers(a,q.specpalette,e.scale,e.layercontainerid);var i=q.batchpathscan(a,e.pathomit),l=q.batchinternodes(i,e),r={layers:q.batchtracelayers(l,e.ltres,e.qtres),palette:n.palette,width:t.width,height:t.height}}return r},this.optionpresets={default:{corsenabled:!1,ltres:1,qtres:1,pathomit:8,rightangleenhance:!0,colorsampling:2,numberofcolors:16,mincolorratio:0,colorquantcycles:3,layering:0,strokewidth:1,linefilter:!1,scale:1,roundcoords:1,viewbox:!1,desc:!1,lcpr:0,qcpr:0,blurradius:0,blurdelta:20},posterized1:{colorsampling:0,numberofcolors:2},posterized2:{numberofcolors:4,blurradius:5},curvy:{ltres:.01,linefilter:!0,rightangleenhance:!1},sharp:{qtres:.01,linefilter:!1},detailed:{pathomit:0,roundcoords:2,ltres:.5,qtres:.5,numberofcolors:64},smoothed:{blurradius:5,blurdelta:64},grayscale:{colorsampling:0,colorquantcycles:1,numberofcolors:7},fixedpalette:{colorsampling:0,colorquantcycles:1,numberofcolors:27},randomsampling1:{colorsampling:1,numberofcolors:8},randomsampling2:{colorsampling:1,numberofcolors:64},artistic1:{colorsampling:0,colorquantcycles:1,pathomit:0,blurradius:5,blurdelta:64,ltres:.01,linefilter:!0,numberofcolors:16,strokewidth:2},artistic2:{qtres:.01,colorsampling:0,colorquantcycles:1,numberofcolors:4,strokewidth:0},artistic3:{qtres:10,ltres:10,numberofcolors:8},artistic4:{qtres:10,ltres:10,numberofcolors:64,blurradius:5,blurdelta:256,strokewidth:2},posterized3:{ltres:1,qtres:1,pathomit:20,rightangleenhance:!0,colorsampling:0,numberofcolors:3,mincolorratio:0,colorquantcycles:3,blurradius:3,blurdelta:20,strokewidth:0,linefilter:!1,roundcoords:1,pal:[{r:0,g:0,b:100,a:255},{r:255,g:255,b:255,a:255}]}},this.checkoptions=function(t){"string"==typeof(t=t||{})&&(t=t.toLowerCase(),t=q.optionpresets[t]?q.optionpresets[t]:{});for(var e=Object.keys(q.optionpresets.default),n=0;n<e.length;n++)t.hasOwnProperty(e[n])||(t[e[n]]=q.optionpresets.default[e[n]]);return t},this.colorquantization=function(t,e){var n,r,o,s,a,i,l,c,h=[],g=0,d=[],p=t.width*t.height;if(t.data.length<4*p){for(var u=new Uint8ClampedArray(4*p),m=0;m<p;m++)u[4*m]=t.data[3*m],u[4*m+1]=t.data[3*m+1],u[4*m+2]=t.data[3*m+2],u[4*m+3]=255;t.data=u}for(a=0;a<t.height+2;a++)for(h[a]=[],s=0;s<t.width+2;s++)h[a][s]=-1;for(c=e.pal?e.pal:0===e.colorsampling?q.generatepalette(e.numberofcolors):1===e.colorsampling?q.samplepalette(e.numberofcolors,t):q.samplepalette2(e.numberofcolors,t),0<e.blurradius&&(t=q.blur(t,e.blurradius,e.blurdelta)),l=0;l<e.colorquantcycles;l++){if(0<l)for(i=0;i<c.length;i++)0<d[i].n&&(c[i]={r:Math.floor(d[i].r/d[i].n),g:Math.floor(d[i].g/d[i].n),b:Math.floor(d[i].b/d[i].n),a:Math.floor(d[i].a/d[i].n)}),d[i].n/p<e.mincolorratio&&l<e.colorquantcycles-1&&(c[i]={r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:Math.floor(255*Math.random())});for(s=0;s<c.length;s++)d[s]={r:0,g:0,b:0,a:0,n:0};for(a=0;a<t.height;a++)for(s=0;s<t.width;s++){for(g=4*(a*t.width+s),r=1024,i=o=0;i<c.length;i++)(n=Math.abs(c[i].r-t.data[g])+Math.abs(c[i].g-t.data[g+1])+Math.abs(c[i].b-t.data[g+2])+Math.abs(c[i].a-t.data[g+3]))<r&&(r=n,o=i);d[o].r+=t.data[g],d[o].g+=t.data[g+1],d[o].b+=t.data[g+2],d[o].a+=t.data[g+3],d[o].n++,h[a+1][s+1]=o}}return{array:h,palette:c}},this.samplepalette=function(t,e){for(var n,r=[],o=0;o<t;o++)n=4*Math.floor(Math.random()*e.data.length/4),r.push({r:e.data[n],g:e.data[1+n],b:e.data[2+n],a:e.data[3+n]});return r},this.samplepalette2=function(t,e){for(var n,r=[],o=Math.ceil(Math.sqrt(t)),s=Math.ceil(t/o),a=e.width/(o+1),i=e.height/(s+1),l=0;l<s;l++)for(var c=0;c<o&&r.length!==t;c++)n=4*Math.floor((l+1)*i*e.width+(c+1)*a),r.push({r:e.data[n],g:e.data[1+n],b:e.data[2+n],a:e.data[3+n]});return r},this.generatepalette=function(t){var e,n,r=[];if(t<8)for(var o=Math.floor(255/(t-1)),s=0;s<t;s++)r.push({r:s*o,g:s*o,b:s*o,a:255});else{for(var a=Math.floor(Math.pow(t,1/3)),i=Math.floor(255/(a-1)),l=t-a*a*a,c=0;c<a;c++)for(e=0;e<a;e++)for(n=0;n<a;n++)r.push({r:c*i,g:e*i,b:n*i,a:255});for(c=0;c<l;c++)r.push({r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:Math.floor(255*Math.random())})}return r},this.layering=function(t){for(var e,n,r,o,s,a,i,l,c,h,g=[],d=0,p=t.array.length,u=t.array[0].length,m=0;m<t.palette.length;m++)for(g[m]=[],h=0;h<p;h++)for(g[m][h]=[],c=0;c<u;c++)g[m][h][c]=0;for(h=1;h<p-1;h++)for(c=1;c<u-1;c++)d=t.array[h][c],e=t.array[h-1][c-1]===d?1:0,n=t.array[h-1][c]===d?1:0,r=t.array[h-1][c+1]===d?1:0,o=t.array[h][c-1]===d?1:0,s=t.array[h][c+1]===d?1:0,a=t.array[h+1][c-1]===d?1:0,i=t.array[h+1][c]===d?1:0,l=t.array[h+1][c+1]===d?1:0,g[d][h+1][c+1]=1+2*s+4*l+8*i,o||(g[d][h+1][c]=2+4*i+8*a),n||(g[d][h][c+1]=0+2*r+4*s+8),e||(g[d][h][c]=0+2*n+4+8*o);return g},this.layeringstep=function(t,e){for(var n,r=[],o=t.array.length,s=t.array[0].length,a=0;a<o;a++)for(r[a]=[],n=0;n<s;n++)r[a][n]=0;for(a=1;a<o;a++)for(n=1;n<s;n++)r[a][n]=(t.array[a-1][n-1]===e?1:0)+(t.array[a-1][n]===e?2:0)+(t.array[a][n-1]===e?8:0)+(t.array[a][n]===e?4:0);return r},this.pointinpoly=function(t,e){for(var n=!1,r=0,o=e.length-1;r<e.length;o=r++)n=e[r].y>t.y!=e[o].y>t.y&&t.x<(e[o].x-e[r].x)*(t.y-e[r].y)/(e[o].y-e[r].y)+e[r].x?!n:n;return n},this.pathscan_combined_lookup=[[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[13,3,0,1],[13,2,-1,0],[7,1,0,-1],[7,0,1,0]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[11,1,0,-1],[14,0,1,0],[14,3,0,1],[11,2,-1,0]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]],this.pathscan=function(t,e){for(var n,r=[],o=0,s=0,a=0,i=0,l=t[0].length,c=t.length,h=0,g=!0,d=!1,p=0;p<c;p++)for(var u=0;u<l;u++)if(4==t[p][u]||11==t[p][u])for(a=u,i=p,r[o]={},r[o].points=[],r[o].boundingbox=[a,i,a,i],g=!(r[o].holechildren=[]),s=0,d=11==t[p][u],h=1;!g;){if(r[o].points[s]={},r[o].points[s].x=a-1,r[o].points[s].y=i-1,r[o].points[s].t=t[i][a],a-1<r[o].boundingbox[0]&&(r[o].boundingbox[0]=a-1),a-1>r[o].boundingbox[2]&&(r[o].boundingbox[2]=a-1),i-1<r[o].boundingbox[1]&&(r[o].boundingbox[1]=i-1),i-1>r[o].boundingbox[3]&&(r[o].boundingbox[3]=i-1),n=q.pathscan_combined_lookup[t[i][a]][h],t[i][a]=n[0],h=n[1],a+=n[2],i+=n[3],a-1===r[o].points[0].x&&i-1===r[o].points[0].y)if(g=!0,r[o].points.length<e)r.pop();else{if(r[o].isholepath=!!d,d){for(var m=0,f=[-1,-1,l+1,c+1],y=0;y<o;y++)!r[y].isholepath&&q.boundingboxincludes(r[y].boundingbox,r[o].boundingbox)&&q.boundingboxincludes(f,r[y].boundingbox)&&q.pointinpoly(r[o].points[0],r[y].points)&&(f=r[m=y].boundingbox);r[m].holechildren.push(o)}o++}s++}return r},this.boundingboxincludes=function(t,e){return t[0]<e[0]&&t[1]<e[1]&&t[2]>e[2]&&t[3]>e[3]},this.batchpathscan=function(t,e){var n=[];for(var r in t)t.hasOwnProperty(r)&&(n[r]=q.pathscan(t[r],e));return n},this.internodes=function(t,e){for(var n,r=[],o=0,s=0,a=0,i=0,l=0,c=0;c<t.length;c++)for(r[c]={},r[c].points=[],r[c].boundingbox=t[c].boundingbox,r[c].holechildren=t[c].holechildren,r[c].isholepath=t[c].isholepath,o=t[c].points.length,n=0;n<o;n++)s=(n+1)%o,a=(n+2)%o,i=(n-1+o)%o,l=(n-2+o)%o,e.rightangleenhance&&q.testrightangle(t[c],l,i,n,s,a)&&(0<r[c].points.length&&(r[c].points[r[c].points.length-1].linesegment=q.getdirection(r[c].points[r[c].points.length-1].x,r[c].points[r[c].points.length-1].y,t[c].points[n].x,t[c].points[n].y)),r[c].points.push({x:t[c].points[n].x,y:t[c].points[n].y,linesegment:q.getdirection(t[c].points[n].x,t[c].points[n].y,(t[c].points[n].x+t[c].points[s].x)/2,(t[c].points[n].y+t[c].points[s].y)/2)})),r[c].points.push({x:(t[c].points[n].x+t[c].points[s].x)/2,y:(t[c].points[n].y+t[c].points[s].y)/2,linesegment:q.getdirection((t[c].points[n].x+t[c].points[s].x)/2,(t[c].points[n].y+t[c].points[s].y)/2,(t[c].points[s].x+t[c].points[a].x)/2,(t[c].points[s].y+t[c].points[a].y)/2)});return r},this.testrightangle=function(t,e,n,r,o,s){return t.points[r].x===t.points[e].x&&t.points[r].x===t.points[n].x&&t.points[r].y===t.points[o].y&&t.points[r].y===t.points[s].y||t.points[r].y===t.points[e].y&&t.points[r].y===t.points[n].y&&t.points[r].x===t.points[o].x&&t.points[r].x===t.points[s].x},this.getdirection=function(t,e,n,r){return t<n?e<r?1:r<e?7:0:n<t?e<r?3:r<e?5:4:e<r?2:r<e?6:8},this.batchinternodes=function(t,e){var n=[];for(var r in t)t.hasOwnProperty(r)&&(n[r]=q.internodes(t[r],e));return n},this.tracepath=function(t,e,n){var r,o,s,a=0,i={segments:[]};for(i.boundingbox=t.boundingbox,i.holechildren=t.holechildren,i.isholepath=t.isholepath;a<t.points.length;){for(r=t.points[a].linesegment,o=-1,s=a+1;(t.points[s].linesegment===r||t.points[s].linesegment===o||-1===o)&&s<t.points.length-1;)t.points[s].linesegment!==r&&-1===o&&(o=t.points[s].linesegment),s++;s===t.points.length-1&&(s=0),i.segments=i.segments.concat(q.fitseq(t,e,n,a,s)),a=0<s?s:t.points.length}return i},this.fitseq=function(t,e,n,r,o){if(o>t.points.length||o<0)return[];var s,a,i,l=r,c=0,h=!0,g=o-r;g<0&&(g+=t.points.length);for(var d,p=(t.points[o].x-t.points[r].x)/g,u=(t.points[o].y-t.points[r].y)/g,m=(r+1)%t.points.length;m!=o;)(d=m-r)<0&&(d+=t.points.length),s=t.points[r].x+p*d,a=t.points[r].y+u*d,e<(i=(t.points[m].x-s)*(t.points[m].x-s)+(t.points[m].y-a)*(t.points[m].y-a))&&(h=!1),c<i&&(l=m,c=i),m=(m+1)%t.points.length;if(h)return[{type:"L",x1:t.points[r].x,y1:t.points[r].y,x2:t.points[o].x,y2:t.points[o].y}];for(var f=l,h=!0,c=0,y=(f-r)/g,b=(1-y)*(1-y),x=2*(1-y)*y,w=y*y,v=(b*t.points[r].x+w*t.points[o].x-t.points[f].x)/-x,M=(b*t.points[r].y+w*t.points[o].y-t.points[f].y)/-x,m=r+1;m!=o;)x=2*(1-(y=(m-r)/g))*y,w=y*y,s=(b=(1-y)*(1-y))*t.points[r].x+x*v+w*t.points[o].x,a=b*t.points[r].y+x*M+w*t.points[o].y,n<(i=(t.points[m].x-s)*(t.points[m].x-s)+(t.points[m].y-a)*(t.points[m].y-a))&&(h=!1),c<i&&(l=m,c=i),m=(m+1)%t.points.length;if(h)return[{type:"Q",x1:t.points[r].x,y1:t.points[r].y,x2:v,y2:M,x3:t.points[o].x,y3:t.points[o].y}];var k=f;return q.fitseq(t,e,n,r,k).concat(q.fitseq(t,e,n,k,o))},this.batchtracepaths=function(t,e,n){var r=[];for(var o in t)t.hasOwnProperty(o)&&r.push(q.tracepath(t[o],e,n));return r},this.batchtracelayers=function(t,e,n){var r=[];for(var o in t)t.hasOwnProperty(o)&&(r[o]=q.batchtracepaths(t[o],e,n));return r},this.roundtodec=function(t,e){return+t.toFixed(e)},this.svgpathstring=function(t,e,n,r){var o=t.layers[e],s=o[n],a="";if(r.linefilter&&s.segments.length<3)return a;if(a="<path "+(r.desc?'desc="l '+e+" p "+n+'" ':"")+q.tosvgcolorstr(t.palette[e],r)+'d="',-1===r.roundcoords){for(a+="M "+s.segments[0].x1*r.scale+" "+s.segments[0].y1*r.scale+" ",c=0;c<s.segments.length;c++)a+=s.segments[c].type+" "+s.segments[c].x2*r.scale+" "+s.segments[c].y2*r.scale+" ",s.segments[c].hasOwnProperty("x3")&&(a+=s.segments[c].x3*r.scale+" "+s.segments[c].y3*r.scale+" ");a+="Z "}else{for(a+="M "+q.roundtodec(s.segments[0].x1*r.scale,r.roundcoords)+" "+q.roundtodec(s.segments[0].y1*r.scale,r.roundcoords)+" ",c=0;c<s.segments.length;c++)a+=s.segments[c].type+" "+q.roundtodec(s.segments[c].x2*r.scale,r.roundcoords)+" "+q.roundtodec(s.segments[c].y2*r.scale,r.roundcoords)+" ",s.segments[c].hasOwnProperty("x3")&&(a+=q.roundtodec(s.segments[c].x3*r.scale,r.roundcoords)+" "+q.roundtodec(s.segments[c].y3*r.scale,r.roundcoords)+" ");a+="Z "}for(var i=0;i<s.holechildren.length;i++){var l=o[s.holechildren[i]];if(-1===r.roundcoords)for(l.segments[l.segments.length-1].hasOwnProperty("x3")?a+="M "+l.segments[l.segments.length-1].x3*r.scale+" "+l.segments[l.segments.length-1].y3*r.scale+" ":a+="M "+l.segments[l.segments.length-1].x2*r.scale+" "+l.segments[l.segments.length-1].y2*r.scale+" ",c=l.segments.length-1;0<=c;c--)a+=l.segments[c].type+" ",l.segments[c].hasOwnProperty("x3")&&(a+=l.segments[c].x2*r.scale+" "+l.segments[c].y2*r.scale+" "),a+=l.segments[c].x1*r.scale+" "+l.segments[c].y1*r.scale+" ";else for(l.segments[l.segments.length-1].hasOwnProperty("x3")?a+="M "+q.roundtodec(l.segments[l.segments.length-1].x3*r.scale)+" "+q.roundtodec(l.segments[l.segments.length-1].y3*r.scale)+" ":a+="M "+q.roundtodec(l.segments[l.segments.length-1].x2*r.scale)+" "+q.roundtodec(l.segments[l.segments.length-1].y2*r.scale)+" ",c=l.segments.length-1;0<=c;c--)a+=l.segments[c].type+" ",l.segments[c].hasOwnProperty("x3")&&(a+=q.roundtodec(l.segments[c].x2*r.scale)+" "+q.roundtodec(l.segments[c].y2*r.scale)+" "),a+=q.roundtodec(l.segments[c].x1*r.scale)+" "+q.roundtodec(l.segments[c].y1*r.scale)+" ";a+="Z "}if(a+='" />',r.lcpr||r.qcpr){for(c=0;c<s.segments.length;c++)s.segments[c].hasOwnProperty("x3")&&r.qcpr&&(a+='<circle cx="'+s.segments[c].x2*r.scale+'" cy="'+s.segments[c].y2*r.scale+'" r="'+r.qcpr+'" fill="cyan" stroke-width="'+.2*r.qcpr+'" stroke="black" />',a+='<circle cx="'+s.segments[c].x3*r.scale+'" cy="'+s.segments[c].y3*r.scale+'" r="'+r.qcpr+'" fill="white" stroke-width="'+.2*r.qcpr+'" stroke="black" />',a+='<line x1="'+s.segments[c].x1*r.scale+'" y1="'+s.segments[c].y1*r.scale+'" x2="'+s.segments[c].x2*r.scale+'" y2="'+s.segments[c].y2*r.scale+'" stroke-width="'+.2*r.qcpr+'" stroke="cyan" />',a+='<line x1="'+s.segments[c].x2*r.scale+'" y1="'+s.segments[c].y2*r.scale+'" x2="'+s.segments[c].x3*r.scale+'" y2="'+s.segments[c].y3*r.scale+'" stroke-width="'+.2*r.qcpr+'" stroke="cyan" />'),!s.segments[c].hasOwnProperty("x3")&&r.lcpr&&(a+='<circle cx="'+s.segments[c].x2*r.scale+'" cy="'+s.segments[c].y2*r.scale+'" r="'+r.lcpr+'" fill="white" stroke-width="'+.2*r.lcpr+'" stroke="black" />');for(i=0;i<s.holechildren.length;i++)for(var l=o[s.holechildren[i]],c=0;c<l.segments.length;c++)l.segments[c].hasOwnProperty("x3")&&r.qcpr&&(a+='<circle cx="'+l.segments[c].x2*r.scale+'" cy="'+l.segments[c].y2*r.scale+'" r="'+r.qcpr+'" fill="cyan" stroke-width="'+.2*r.qcpr+'" stroke="black" />',a+='<circle cx="'+l.segments[c].x3*r.scale+'" cy="'+l.segments[c].y3*r.scale+'" r="'+r.qcpr+'" fill="white" stroke-width="'+.2*r.qcpr+'" stroke="black" />',a+='<line x1="'+l.segments[c].x1*r.scale+'" y1="'+l.segments[c].y1*r.scale+'" x2="'+l.segments[c].x2*r.scale+'" y2="'+l.segments[c].y2*r.scale+'" stroke-width="'+.2*r.qcpr+'" stroke="cyan" />',a+='<line x1="'+l.segments[c].x2*r.scale+'" y1="'+l.segments[c].y2*r.scale+'" x2="'+l.segments[c].x3*r.scale+'" y2="'+l.segments[c].y3*r.scale+'" stroke-width="'+.2*r.qcpr+'" stroke="cyan" />'),!l.segments[c].hasOwnProperty("x3")&&r.lcpr&&(a+='<circle cx="'+l.segments[c].x2*r.scale+'" cy="'+l.segments[c].y2*r.scale+'" r="'+r.lcpr+'" fill="white" stroke-width="'+.2*r.lcpr+'" stroke="black" />')}return a},this.getsvgstring=function(t,e){e=q.checkoptions(e);for(var n=t.width*e.scale,r=t.height*e.scale,o="<svg "+(e.viewbox?'viewBox="0 0 '+n+" "+r+'" ':'width="'+n+'" height="'+r+'" ')+'version="1.1" xmlns="http://www.w3.org/2000/svg" desc="Created with imagetracer.js version '+q.versionnumber+'" >',s=0;s<t.layers.length;s++)for(var a=0;a<t.layers[s].length;a++)t.layers[s][a].isholepath||(o+=q.svgpathstring(t,s,a,e));return o+="</svg>"},this.compareNumbers=function(t,e){return t-e},this.torgbastr=function(t){return"rgba("+t.r+","+t.g+","+t.b+","+t.a+")"},this.tosvgcolorstr=function(t,e){return'fill="rgb('+t.r+","+t.g+","+t.b+')" stroke="rgb('+t.r+","+t.g+","+t.b+')" stroke-width="'+e.strokewidth+'" opacity="'+t.a/255+'" '},this.appendSVGString=function(t,e){var n;e?(n=document.getElementById(e))||((n=document.createElement("div")).id=e,document.body.appendChild(n)):(n=document.createElement("div"),document.body.appendChild(n)),n.innerHTML+=t},this.gks=[[.27901,.44198,.27901],[.135336,.228569,.272192,.228569,.135336],[.086776,.136394,.178908,.195843,.178908,.136394,.086776],[.063327,.093095,.122589,.144599,.152781,.144599,.122589,.093095,.063327],[.049692,.069304,.089767,.107988,.120651,.125194,.120651,.107988,.089767,.069304,.049692]],this.blur=function(t,e,n){var r,o,s,a,i,l,c,h,g={width:t.width,height:t.height,data:[]};if((e=Math.floor(e))<1)return t;5<e&&(e=5),1024<(n=Math.abs(n))&&(n=1024);for(var d=q.gks[e-1],p=0;p<t.height;p++)for(r=0;r<t.width;r++){for(h=c=l=i=a=0,o=-e;o<e+1;o++)0<r+o&&r+o<t.width&&(s=4*(p*t.width+r+o),a+=t.data[s]*d[o+e],i+=t.data[s+1]*d[o+e],l+=t.data[s+2]*d[o+e],c+=t.data[s+3]*d[o+e],h+=d[o+e]);s=4*(p*t.width+r),g.data[s]=Math.floor(a/h),g.data[s+1]=Math.floor(i/h),g.data[s+2]=Math.floor(l/h),g.data[s+3]=Math.floor(c/h)}var u=new Uint8ClampedArray(g.data);for(p=0;p<t.height;p++)for(r=0;r<t.width;r++){for(h=c=l=i=a=0,o=-e;o<e+1;o++)0<p+o&&p+o<t.height&&(a+=u[s=4*((p+o)*t.width+r)]*d[o+e],i+=u[s+1]*d[o+e],l+=u[s+2]*d[o+e],c+=u[s+3]*d[o+e],h+=d[o+e]);s=4*(p*t.width+r),g.data[s]=Math.floor(a/h),g.data[s+1]=Math.floor(i/h),g.data[s+2]=Math.floor(l/h),g.data[s+3]=Math.floor(c/h)}for(p=0;p<t.height;p++)for(r=0;r<t.width;r++)s=4*(p*t.width+r),n<Math.abs(g.data[s]-t.data[s])+Math.abs(g.data[s+1]-t.data[s+1])+Math.abs(g.data[s+2]-t.data[s+2])+Math.abs(g.data[s+3]-t.data[s+3])&&(g.data[s]=t.data[s],g.data[s+1]=t.data[s+1],g.data[s+2]=t.data[s+2],g.data[s+3]=t.data[s+3]);return u=null,g},this.loadImage=function(t,e,n){var r=new Image;n&&n.corsenabled&&(r.crossOrigin="Anonymous"),r.onload=function(){var t=document.createElement("canvas");t.width=r.width,t.height=r.height,t.getContext("2d").drawImage(r,0,0),e(t)},r.src=t},this.getImgdata=function(t){return t.getContext("2d").getImageData(0,0,t.width,t.height)},this.specpalette=[{r:0,g:0,b:0,a:255},{r:128,g:128,b:128,a:255},{r:0,g:0,b:128,a:255},{r:64,g:64,b:128,a:255},{r:192,g:192,b:192,a:255},{r:255,g:255,b:255,a:255},{r:128,g:128,b:192,a:255},{r:0,g:0,b:192,a:255},{r:128,g:0,b:0,a:255},{r:128,g:64,b:64,a:255},{r:128,g:0,b:128,a:255},{r:168,g:168,b:168,a:255},{r:192,g:128,b:128,a:255},{r:192,g:0,b:0,a:255},{r:255,g:255,b:255,a:255},{r:0,g:128,b:0,a:255}],this.drawLayers=function(t,e,n,r){var o,s,a,i,l;for(i in n=n||1,r?(l=document.getElementById(r))||((l=document.createElement("div")).id=r,document.body.appendChild(l)):(l=document.createElement("div"),document.body.appendChild(l)),t)if(t.hasOwnProperty(i)){o=t[i][0].length,s=t[i].length;var c=document.createElement("canvas");c.width=o*n,c.height=s*n;for(var h=c.getContext("2d"),g=0;g<s;g++)for(a=0;a<o;a++)h.fillStyle=q.torgbastr(e[t[i][g][a]%e.length]),h.fillRect(a*n,g*n,n,n);l.appendChild(c)}}}"function"==typeof define&&define.amd?define(function(){return new t}):"undefined"!=typeof module?module.exports=new t:"undefined"!=typeof self?self.ImageTracer=new t:window.ImageTracer=new t}();